{% extends "base.html" %}
{% load static %}
{% load app_extras %}
{% load crispy_forms_tags %}

{% block title %}
    Add - Yamtrack
{% endblock title %}

{% block container %}
    <h2 class="mb-4">Add Manual Media Entry</h2>
    <form method="post">
        {% csrf_token %}
        {{ form|crispy }}
        {% include "app/components/add_manual_form.html" with form=media_form %}
        <button class="btn btn-secondary" type="submit">Submit</button>
    </form>

    <script>
        document.getElementById('id_media_type').addEventListener('change', function() {
            var seasonFields = document.getElementsByClassName('season-field');
            var episodeFields = document.getElementsByClassName('episode-field');
            
            // Hide all fields first
            for (var field of seasonFields) {
                field.style.display = 'none';
                field.required = false;
                field.labels[0].style.display = 'none';
            }
            for (var field of episodeFields) {
                field.style.display = 'none'; 
                field.required = false;
                field.labels[0].style.display = 'none';
            }

            // Show relevant fields based on media type
            if (this.value === 'season') {
                for (var field of seasonFields) {
                    field.style.display = 'block';
                    field.required = true;
                    field.labels[0].style.display = 'block';
                }
            }
            else if (this.value === 'episode') {
                for (var field of episodeFields) {
                    field.style.display = 'block';
                    field.required = true;
                    field.labels[0].style.display = 'block';
                }
            }
        });
    </script>
{% endblock container %}
